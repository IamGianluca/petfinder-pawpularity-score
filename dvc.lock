schema: '2.0'
stages:
  download_data:
    cmd: kaggle competitions download -c petfinder-pawpularity-score -p data/
    outs:
    - path: data/petfinder-pawpularity-score.zip
      md5: 35dd50bacd33ebba746738508e20e276
      size: 1030728211
  unzip_data:
    cmd: unzip data/petfinder-pawpularity-score.zip -d data/
    deps:
    - path: data/petfinder-pawpularity-score.zip
      md5: 35dd50bacd33ebba746738508e20e276
      size: 1030728211
    outs:
    - path: data/sample_submission.csv
      md5: eed5ebc04c54d5e5130a85a4d81dfc6e
      size: 326
    - path: data/test
      md5: e945e75c5c4c977b08ad644851755e27.dir
      size: 83775
      nfiles: 8
    - path: data/test.csv
      md5: 4e4d1b962044457c29f636cc02716e46
      size: 545
    - path: data/train
      md5: 065c7f4be0d67e5175f532982b56cb52.dir
      size: 1039930050
      nfiles: 9912
    - path: data/train.csv
      md5: a7812f42b71d57e77dfc6e05f5cdd865
      size: 594740
  create_folds:
    cmd: python pipe/create_folds.py
    deps:
    - path: data/train.csv
      md5: a7812f42b71d57e77dfc6e05f5cdd865
      size: 594740
    - path: pipe/create_folds.py
      md5: e11c1727b424d3d2955fd127052f7027
      size: 814
    params:
      params.yaml:
        create_folds:
          seed: 6822
          k: 5
    outs:
    - path: data/train_folds.csv
      md5: ab60389c4822f57583be4cc5f0295df3
      size: 1110176
  train_one:
    cmd: python pipe/train.py
    deps:
    - path: data/train
      md5: 065c7f4be0d67e5175f532982b56cb52.dir
      size: 1039930050
      nfiles: 9912
    - path: data/train_folds.csv
      md5: ab60389c4822f57583be4cc5f0295df3
      size: 1110176
    - path: pipe/train.py
      md5: 55e7d7b4befce1d328a04a5b7f8d1b75
      size: 5347
    params:
      params.yaml:
        train_one:
          seed: 46
          fold: -1
          train_data: data/train
          epochs: 5
          arch: resnet18
          dropout: 0.0
          metric: rmse
          metric_mode: min
          opt: adamw
          sched: plateau
          aug: none
          loss: bce_with_logits
          precision: 32
          sz: 224
          auto_batch_size: false
          bs: 128
          accumulate_grad_batches: 1
          auto_lr: false
          lr: 0.001
          wd: 0.0
          label_smoothing: 0.0
          mom: 0.9
    outs:
    - path: ckpts/model_one_fold0.ckpt
      md5: 2301f3eafcac440ccbafc3d88515d5be
      size: 134247059
    - path: ckpts/model_one_fold1.ckpt
      md5: 0ed47080304ea8f16862158592d8392d
      size: 134247059
    - path: ckpts/model_one_fold2.ckpt
      md5: 36dfb060abcb75f6b34ae8db7757b0e3
      size: 134247059
    - path: ckpts/model_one_fold3.ckpt
      md5: f91544824d6229faa1bb26cce4299317
      size: 134247059
    - path: ckpts/model_one_fold4.ckpt
      md5: f9481b7ea62b920c75e3b85ecaa4bd7b
      size: 134247123
    - path: metrics/model_one.json
      md5: 2da968949c3bff8f031455163aedf3df
      size: 45
    - path: preds/model_one_fold0.npy
      md5: 1fb5d641e17fc68c6fffb5f4ce4ffe50
      size: 8060
    - path: preds/model_one_fold1.npy
      md5: 95d0e615c3c92b867058d48eb1533691
      size: 8060
    - path: preds/model_one_fold2.npy
      md5: 9a14585941f8329df8a066bd0c2f2e4a
      size: 8056
    - path: preds/model_one_fold3.npy
      md5: e51cfc9e661981108d3ed7b7e72a99bb
      size: 8056
    - path: preds/model_one_fold4.npy
      md5: 7baf59a4be1808130f26d6c72d9e2398
      size: 8056
